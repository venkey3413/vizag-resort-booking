<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Admin Panel - Resort Management</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="shortcut icon" href="logo.png">
    <link rel="stylesheet" href="style.css?v=20250103021">
</head>
<body>


    <main class="container">
        <section class="add-resort">
            <h2>Add New Resort</h2>
            <form id="resortForm">
                <input type="hidden" id="resortId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">Resort Name:</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="location">Location:</label>
                        <input type="text" id="location" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="price">Price per Night (‚Çπ):</label>
                        <input type="number" id="price" required>
                    </div>
                    <div class="form-group">
                        <label for="image">Main Image:</label>
                        <input type="url" id="image" placeholder="https://..." readonly>
                        <button type="button" onclick="uploadMainImage()" class="upload-btn">üì∑ Upload Image</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="gallery">Additional Images:</label>
                    <textarea id="gallery" rows="4" placeholder="Uploaded image URLs will appear here" readonly></textarea>
                    <div class="gallery-buttons">
                        <button type="button" onclick="uploadGalleryImages()" class="upload-btn">üñºÔ∏è Upload Gallery Images</button>
                        <button type="button" onclick="removeGalleryImages()" class="remove-btn">üóëÔ∏è Remove Images</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="videos">Videos:</label>
                    <textarea id="videos" rows="3" placeholder="Uploaded video URLs will appear here" readonly></textarea>
                    <button type="button" onclick="uploadVideos()" class="upload-btn">üé• Upload Videos</button>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="mapLink">Google Map Link:</label>
                        <input type="url" id="mapLink" placeholder="https://maps.google.com/?q=location">
                    </div>
                </div>
                <div class="form-group">
                    <label for="description">Description:</label>
                    <textarea id="description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="amenities">Amenities (one per line):</label>
                    <textarea id="amenities" rows="4" placeholder="WiFi\nSwimming Pool\nRestaurant\nFree Parking\nGym\nSpa"></textarea>
                </div>
                <div class="form-group">
                    <label for="note">Payment Note (optional):</label>
                    <textarea id="note" rows="2" placeholder="Special instructions or notes for payment (e.g., 'Pay 50% advance', 'Full payment required')" maxlength="200"></textarea>
                    <small>This note will be displayed during payment if entered. Leave empty to hide.</small>
                </div>
                <div class="form-group">
                    <label for="maxGuests">Maximum Guests (optional):</label>
                    <input type="number" id="maxGuests" min="1" max="50" placeholder="e.g., 6">
                    <small>If set, shows warning when guests exceed this limit. Leave empty for no limit.</small>
                </div>
                <div class="form-group">
                    <label>Dynamic Pricing:</label>
                    <div class="pricing-container">
                        <div class="pricing-row">
                            <label>Weekday (Mon-Thu):</label>
                            <input type="number" id="weekdayPrice" placeholder="‚Çπ per night">
                        </div>
                        <div class="pricing-row">
                            <label>Weekend (Fri-Sun):</label>
                            <input type="number" id="weekendPrice" placeholder="‚Çπ per night">
                        </div>
                        <div class="pricing-row">
                            <label>Holiday/Festival:</label>
                            <input type="number" id="holidayPrice" placeholder="‚Çπ per night">
                        </div>
                    </div>
                    <small>Leave empty to use base price for that day type</small>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="createOwnerAccount"> Create Owner Account for this Resort
                    </label>
                    <div id="ownerCredentials" class="owner-credentials" style="display:none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ownerName">Owner Name:</label>
                                <input type="text" id="ownerName" placeholder="Resort Owner Name">
                            </div>
                            <div class="form-group">
                                <label for="ownerEmail">Owner Email:</label>
                                <input type="email" id="ownerEmail" placeholder="owner@example.com">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="ownerPassword">Owner Password:</label>
                            <input type="password" id="ownerPassword" placeholder="Minimum 6 characters">
                        </div>
                        <small>Owner will be able to login and manage availability for this resort</small>
                    </div>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="createCoupon"> Create Coupon for this Resort
                    </label>
                    <div id="couponCredentials" class="coupon-credentials" style="display:none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="couponResort">Select Resort:</label>
                                <select id="couponResort">
                                    <option value="current">Current Resort</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="couponCode">Coupon Code:</label>
                                <input type="text" id="couponCode" placeholder="e.g., RESORT20" maxlength="20">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="couponType">Discount Type:</label>
                                <select id="couponType">
                                    <option value="percentage">Percentage (%)</option>
                                    <option value="fixed">Fixed Amount (‚Çπ)</option>
                                </select>
                            </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="couponDiscount">Discount Value:</label>
                                <input type="number" id="couponDiscount" placeholder="20" min="1">
                            </div>
                            <div class="form-group">
                                <label for="couponDayType">Valid Days:</label>
                                <select id="couponDayType">
                                    <option value="all">All Days</option>
                                    <option value="weekday">Weekdays (Mon-Fri)</option>
                                    <option value="weekend">Weekends (Sat-Sun)</option>
                                </select>
                            </div>
                        </div>
                        <small>Coupon will be available for customers to use during booking</small>
                    </div>
                </div>
                <button type="submit" id="submitBtn">Add Resort</button>
                <button type="button" id="cancelBtn" onclick="cancelEdit()" style="display:none;">Cancel</button>
            </form>
        </section>

        <section class="resorts-list">
            <h2>Manage Resorts</h2>
            <div id="resortsGrid" class="resorts-grid">
                <!-- Resorts will be loaded here -->
            </div>
        </section>

        <section class="food-management">
            <h2>Food Item Management</h2>

            <div class="food-form">
                <h3>Add/Edit Food Item</h3>
                <form id="foodForm">
                    <input type="hidden" id="foodId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="foodName">Item Name:</label>
                            <input type="text" id="foodName" required>
                        </div>
                        <div class="form-group">
                            <label for="foodPrice">Price (‚Çπ):</label>
                            <input type="number" id="foodPrice" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="foodCategory">Category:</label>
                            <select id="foodCategory" required>
                                <option value="">Select Category</option>
                                <option value="Starters">Starters</option>
                                <option value="Main Course">Main Course</option>
                                <option value="Desserts">Desserts</option>
                                <option value="Beverages">Beverages</option>
                                <option value="Snacks">Snacks</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="foodImage">Image URL:</label>
                            <input type="url" id="foodImage" placeholder="https://..." readonly>
                            <button type="button" onclick="uploadFoodImage()" class="upload-btn">üì∑ Upload Image</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="foodDescription">Description:</label>
                        <textarea id="foodDescription" rows="2"></textarea>
                    </div>
                    <button type="submit" id="foodSubmitBtn">Add Food Item</button>
                    <button type="button" id="foodCancelBtn" onclick="cancelFoodEdit()" style="display:none;">Cancel</button>
                </form>
            </div>

            <div class="food-list">
                <h3>Current Menu Items</h3>
                <div id="foodItemsGrid" class="food-items-grid">
                    <!-- Food items will be loaded here -->
                </div>
            </div>
        </section>

        <section class="travel-management">
            <h2>Travel Package Management</h2>

            <div class="travel-form">
                <h3>Add/Edit Travel Package</h3>
                <form id="travelForm">
                    <input type="hidden" id="travelId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="travelName">Package Name:</label>
                            <input type="text" id="travelName" required>
                        </div>
                        <div class="form-group">
                            <label for="travelPrice">Base Price - 5 Seater (‚Çπ):</label>
                            <input type="number" id="travelPrice" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Car Seater Pricing:</label>
                        <div class="car-pricing-container">
                            <div class="pricing-row">
                                <label>5 Seater:</label>
                                <input type="number" id="price5Seater" placeholder="‚Çπ per trip">
                            </div>
                            <div class="pricing-row">
                                <label>7 Seater:</label>
                                <input type="number" id="price7Seater" placeholder="‚Çπ per trip">
                            </div>
                            <div class="pricing-row">
                                <label>12 Seater:</label>
                                <input type="number" id="price12Seater" placeholder="‚Çπ per trip">
                            </div>
                            <div class="pricing-row">
                                <label>14 Seater:</label>
                                <input type="number" id="price14Seater" placeholder="‚Çπ per trip">
                            </div>
                        </div>
                        <small>Set fixed prices for each car type manually.</small>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="travelDuration">Duration:</label>
                            <input type="text" id="travelDuration" placeholder="e.g., 8-10 hours" required>
                        </div>
                        <div class="form-group">
                            <label for="travelImage">Main Image URL:</label>
                            <input type="url" id="travelImage" placeholder="https://..." readonly>
                            <button type="button" onclick="uploadTravelImage()" class="upload-btn">üì∑ Upload Image</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="travelGallery">Additional Images (Gallery):</label>
                        <textarea id="travelGallery" rows="4" placeholder="Uploaded image URLs will appear here" readonly></textarea>
                        <div class="gallery-buttons">
                            <button type="button" onclick="uploadTravelGalleryImages()" class="upload-btn">üñºÔ∏è Upload Gallery Images</button>
                            <button type="button" onclick="removeTravelGalleryImages()" class="remove-btn">üóëÔ∏è Remove Images</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="travelDescription">Description:</label>
                        <textarea id="travelDescription" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="travelSites">Sites/Places to Visit (one per line):</label>
                        <textarea id="travelSites" rows="4" placeholder="Araku Valley\nBorra Caves\nKatiki Waterfalls\nLambasingi\nTyda Nature Camp"></textarea>
                    </div>
                    <button type="submit" id="travelSubmitBtn">Add Travel Package</button>
                    <button type="button" id="travelCancelBtn" onclick="cancelTravelEdit()" style="display:none;">Cancel</button>
                </form>
            </div>

            <div class="travel-list">
                <h3>Current Travel Packages</h3>
                <div id="travelPackagesGrid" class="travel-packages-grid">
                    <!-- Travel packages will be loaded here -->
                </div>
            </div>
        </section>

        <section class="coupon-management">
            <h2>Coupon Management</h2>
            <div class="coupon-list">
                <h3>Active Coupons</h3>
                <div id="couponsGrid" class="coupons-grid">
                    <!-- Coupons will be loaded here -->
                </div>
            </div>
        </section>

        <section class="owner-management">
            <h2>Owner Management</h2>
            <div class="owner-list">
                <h3>Resort Owners</h3>
                <div id="ownersGrid" class="owners-grid">
                    <!-- Owners will be loaded here -->
                </div>
            </div>
        </section>
    </main>

    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        // Replace with your Cloudinary cloud name
        const CLOUDINARY_CLOUD_NAME = 'dqdclezfo';
        
        function uploadMainImage() {
            cloudinary.openUploadWidget({
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: 'resort_images',
                sources: ['local', 'url'],
                multiple: false,
                resourceType: 'image',
                maxFileSize: 10000000,
                cropping: true,
                croppingAspectRatio: 16/9
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    document.getElementById('image').value = result.info.secure_url;
                }
            });
        }
        
        function uploadGalleryImages() {
            cloudinary.openUploadWidget({
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: 'resort_images',
                sources: ['local', 'url'],
                multiple: true,
                resourceType: 'image',
                maxFileSize: 10000000
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    const currentGallery = document.getElementById('gallery').value;
                    const newUrl = result.info.secure_url;
                    const updatedGallery = currentGallery ? currentGallery + '\n' + newUrl : newUrl;
                    document.getElementById('gallery').value = updatedGallery;
                }
            });
        }
        
        function removeGalleryImages() {
            const galleryTextarea = document.getElementById('gallery');
            const currentGallery = galleryTextarea.value.trim();
            
            if (!currentGallery) {
                alert('No images to remove');
                return;
            }
            
            const images = currentGallery.split('\n').filter(url => url.trim());
            
            if (images.length === 0) {
                alert('No images to remove');
                return;
            }
            
            const modal = document.createElement('div');
            modal.className = 'image-removal-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>Select Images to Remove</h3>
                    <div class="images-grid">
                        ${images.map((url, index) => `
                            <div class="image-item">
                                <img src="${url}" alt="Gallery Image ${index + 1}">
                                <label>
                                    <input type="checkbox" value="${index}"> Remove
                                </label>
                            </div>
                        `).join('')}
                    </div>
                    <div class="modal-actions">
                        <button onclick="confirmRemoveResortImages()">Remove Selected</button>
                        <button onclick="closeResortRemovalModal()">Cancel</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            window.confirmRemoveResortImages = function() {
                const checkboxes = modal.querySelectorAll('input[type="checkbox"]:checked');
                const indicesToRemove = Array.from(checkboxes).map(cb => parseInt(cb.value));
                
                if (indicesToRemove.length === 0) {
                    alert('Please select at least one image to remove');
                    return;
                }
                
                const remainingImages = images.filter((_, index) => !indicesToRemove.includes(index));
                galleryTextarea.value = remainingImages.join('\n');
                
                closeResortRemovalModal();
                alert(`Removed ${indicesToRemove.length} image(s)`);
            };
            
            window.closeResortRemovalModal = function() {
                modal.remove();
                delete window.confirmRemoveResortImages;
                delete window.closeResortRemovalModal;
            };
        }
        
        function uploadVideos() {
            cloudinary.openUploadWidget({
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: 'resort_videos',
                sources: ['local', 'url'],
                multiple: true,
                resourceType: 'video',
                maxFileSize: 100000000
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    const currentVideos = document.getElementById('videos').value;
                    const newUrl = result.info.secure_url;
                    const updatedVideos = currentVideos ? currentVideos + '\n' + newUrl : newUrl;
                    document.getElementById('videos').value = updatedVideos;
                }
            });
        }
        
        function uploadFoodImage() {
            cloudinary.openUploadWidget({
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: 'resort_images',
                sources: ['local', 'url'],
                multiple: false,
                resourceType: 'image',
                maxFileSize: 10000000,
                cropping: true,
                croppingAspectRatio: 1
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    document.getElementById('foodImage').value = result.info.secure_url;
                }
            });
        }
        
        function uploadTravelImage() {
            cloudinary.openUploadWidget({
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: 'resort_images',
                sources: ['local', 'url'],
                multiple: false,
                resourceType: 'image',
                maxFileSize: 10000000,
                cropping: true,
                croppingAspectRatio: 16/9
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    document.getElementById('travelImage').value = result.info.secure_url;
                }
            });
        }
        
        function uploadTravelGalleryImages() {
            cloudinary.openUploadWidget({
                cloudName: CLOUDINARY_CLOUD_NAME,
                uploadPreset: 'resort_images',
                sources: ['local', 'url'],
                multiple: true,
                resourceType: 'image',
                maxFileSize: 10000000
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    const currentGallery = document.getElementById('travelGallery').value;
                    const newUrl = result.info.secure_url;
                    const updatedGallery = currentGallery ? currentGallery + '\n' + newUrl : newUrl;
                    document.getElementById('travelGallery').value = updatedGallery;
                }
            });
        }
        
        function removeTravelGalleryImages() {
            const galleryTextarea = document.getElementById('travelGallery');
            const currentGallery = galleryTextarea.value.trim();
            
            if (!currentGallery) {
                alert('No images to remove');
                return;
            }
            
            const images = currentGallery.split('\n').filter(url => url.trim());
            
            if (images.length === 0) {
                alert('No images to remove');
                return;
            }
            
            // Create a modal to show images for selection
            const modal = document.createElement('div');
            modal.className = 'image-removal-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>Select Images to Remove</h3>
                    <div class="images-grid">
                        ${images.map((url, index) => `
                            <div class="image-item">
                                <img src="${url}" alt="Gallery Image ${index + 1}">
                                <label>
                                    <input type="checkbox" value="${index}"> Remove
                                </label>
                            </div>
                        `).join('')}
                    </div>
                    <div class="modal-actions">
                        <button onclick="confirmRemoveImages()">Remove Selected</button>
                        <button onclick="closeRemovalModal()">Cancel</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Add modal styles
            const style = document.createElement('style');
            style.textContent = `
                .image-removal-modal {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.8);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                }
                .image-removal-modal .modal-content {
                    background: white;
                    padding: 2rem;
                    border-radius: 10px;
                    max-width: 80%;
                    max-height: 80%;
                    overflow-y: auto;
                }
                .images-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                    gap: 1rem;
                    margin: 1rem 0;
                }
                .image-item {
                    text-align: center;
                }
                .image-item img {
                    width: 100%;
                    height: 100px;
                    object-fit: cover;
                    border-radius: 5px;
                }
                .modal-actions {
                    text-align: center;
                    margin-top: 1rem;
                }
                .modal-actions button {
                    margin: 0 0.5rem;
                    padding: 0.5rem 1rem;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                }
                .modal-actions button:first-child {
                    background: #dc3545;
                    color: white;
                }
                .modal-actions button:last-child {
                    background: #6c757d;
                    color: white;
                }
            `;
            document.head.appendChild(style);
            
            window.confirmRemoveImages = function() {
                const checkboxes = modal.querySelectorAll('input[type="checkbox"]:checked');
                const indicesToRemove = Array.from(checkboxes).map(cb => parseInt(cb.value));
                
                if (indicesToRemove.length === 0) {
                    alert('Please select at least one image to remove');
                    return;
                }
                
                const remainingImages = images.filter((_, index) => !indicesToRemove.includes(index));
                galleryTextarea.value = remainingImages.join('\n');
                
                closeRemovalModal();
                alert(`Removed ${indicesToRemove.length} image(s)`);
            };
            
            window.closeRemovalModal = function() {
                modal.remove();
                style.remove();
                delete window.confirmRemoveImages;
                delete window.closeRemovalModal;
            };
        }
        

    </script>
    <script src="script.js?v=20250103020"></script>
</body>
</html>